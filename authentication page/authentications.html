<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ZFF - Secure authentication portal for pharmacy workforce management">
    <title>ZFF - Authentication Portal</title>
    <link rel="stylesheet" href="../css/main.css">
    <script type="module" async src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fpharmacrew5062back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.10"></script>
    <script type="module" defer src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
    </head>
<body class="bg-background min-h-screen flex items-center justify-center p-4">
    <!-- Background Pattern -->
    <div class="fixed inset-0 z-0 opacity-5">
        <svg class="w-full h-full" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="currentColor" stroke-width="1"/>
                </pattern>
            </defs>
            <rect width="100%" height="100%" fill="url(#grid)" class="text-primary"/>
        </svg>
    </div>

    <!-- Main Authentication Container -->
    <main class="relative z-10 w-full max-w-md animate-fade-in">
        <!-- Security Trust Badges Header -->
        <header class="text-center mb-8">
            <div class="flex justify-center items-center gap-4 mb-6">
                <!-- HIPAA Compliance Badge -->
                <div class="flex items-center gap-2 bg-surface px-3 py-2 rounded-lg border border-border shadow-sm">
                    <img src="https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?w=32&h=32&fit=crop" 
                    alt="HIPAA compliance certification badge" 
                    class="w-6 h-6 object-contain"
                    onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    <span class="text-xs font-medium text-text-secondary">HIPAA</span>
                </div>
                <!-- SOC 2 Compliance Badge -->
                <div class="flex items-center gap-2 bg-surface px-3 py-2 rounded-lg border border-border shadow-sm">
                    <img src="https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=32&h=32&fit=crop" 
                    alt="SOC 2 Type II security certification badge" 
                    class="w-6 h-6 object-contain"
                    onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    <span class="text-xs font-medium text-text-secondary">SOC 2</span>
                </div>
                <!-- SSL Encryption Badge -->
                <div class="flex items-center gap-2 bg-surface px-3 py-2 rounded-lg border border-border shadow-sm">
                    <img src="https://images.unsplash.com/photo-1614064641938-3bbee52942c7?w=32&h=32&fit=crop" 
                    alt="256-bit SSL encryption security badge" 
                    class="w-6 h-6 object-contain"
                    onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;">
                    <span class="text-xs font-medium text-text-secondary">256-bit SSL</span>
                </div>
            </div>
        </header>

        <!-- Authentication Card -->
        <article class="card p-8 shadow-lg">
            <!-- Logo and Title -->
            <div class="text-center mb-8">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-xl mb-4">
                    <svg class="w-10 h-10 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                    </svg>
                </div>
                <h1 class="text-3xl font-semibold text-text-primary mb-2">PharmaCrew</h1>
                <p class="text-text-secondary text-sm">Pharmacy Workforce Management Portal</p>
            </div>

            <!-- System Status Indicators -->
            <div class="flex items-center justify-center gap-4 mb-6 p-3 bg-background rounded-lg">
                <div class="flex items-center gap-2">
                    <span class="status-indicator status-active" aria-label="LDAP directory service active"></span>
                    <span class="text-xs text-text-secondary">LDAP Active</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="status-indicator status-active" aria-label="Backup authentication available"></span>
                    <span class="text-xs text-text-secondary">Backup Auth</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="status-indicator status-active" aria-label="System operational"></span>
                    <span class="text-xs text-text-secondary">System OK</span>
                </div>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="space-y-5" novalidate>
                <!-- Username Field -->
                <div>
                    <label for="username" class="block text-sm font-medium text-text-primary mb-2">
                        Username or Email
                        <span class="text-accent" aria-label="required">*</span>
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <img src="https://api.iconify.design/mdi:account-outline.svg?color=%236B7280" 
                            alt="" 
                            class="w-5 h-5"
                            aria-hidden="true">
                        </div>
                        <input type="text" 
                        id="username" 
                        name="username" 
                        class="input pl-10" 
                        placeholder="Enter your username"
                        autocomplete="username"
                        required
                        aria-required="true"
                        aria-describedby="username-error">
                    </div>
                    <p id="username-error" class="mt-1 text-xs text-error hidden" role="alert">Please enter a valid username</p>
                </div>

                <!-- Password Field -->
                <div>
                    <label for="password" class="block text-sm font-medium text-text-primary mb-2">
                        Password
                        <span class="text-accent" aria-label="required">*</span>
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <img src="https://api.iconify.design/mdi:lock-outline.svg?color=%236B7280" 
                                alt="" 
                                class="w-5 h-5"
                                aria-hidden="true">
                        </div>
                        <input type="password" 
                                id="password" 
                                name="password" 
                                class="input pl-10 pr-10" 
                                placeholder="Enter your password"
                                autocomplete="current-password"
                                required
                                aria-required="true"
                                aria-describedby="password-error password-strength">
                        <button type="button" 
                                id="togglePassword" 
                                class="absolute inset-y-0 right-0 pr-3 flex items-center focus-visible-ring rounded"
                                aria-label="Toggle password visibility">
                            <img src="https://api.iconify.design/mdi:eye-outline.svg?color=%236B7280" 
                                    alt="" 
                                    class="w-5 h-5"
                                    id="eyeIcon"
                                    aria-hidden="true">
                        </button>
                    </div>
                    <p id="password-error" class="mt-1 text-xs text-error hidden" role="alert">Please enter your password</p>
                    <!-- Password Strength Indicator -->
                    <div id="password-strength" class="mt-2 hidden">
                        <div class="flex items-center gap-2">
                            <div class="flex-1 h-1 bg-border rounded-full overflow-hidden">
                                <div id="strength-bar" class="h-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                            <span id="strength-text" class="text-xs text-text-secondary"></span>
                        </div>
                    </div>
                </div>

                <!-- Role Selection -->
                <div>
                    <label for="role" class="block text-sm font-medium text-text-primary mb-2">
                        Role
                        <span class="text-accent" aria-label="required">*</span>
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <img src="https://api.iconify.design/mdi:badge-account-outline.svg?color=%236B7280" 
                                    alt="" 
                                    class="w-5 h-5"
                                    aria-hidden="true">
                        </div>
                        <select id="role" 
                                name="role" 
                                class="input pl-10 appearance-none cursor-pointer"
                                required
                                aria-required="true"
                                aria-describedby="role-error">
                            <option value="">Select your role</option>
                            <option value="manager">Pharmacy Manager</option>
                            <option value="pharmacist">Staff Pharmacist</option>
                            <option value="technician">Pharmacy Technician</option>
                            <option value="supervisor">District Supervisor</option>
                        </select>
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                            <img src="https://api.iconify.design/mdi:chevron-down.svg?color=%236B7280" 
                                    alt="" 
                                    class="w-5 h-5"
                                    aria-hidden="true">
                        </div>
                    </div>
                    <p id="role-error" class="mt-1 text-xs text-error hidden" role="alert">Please select your role</p>
                </div>

                <!-- MFA Token (Optional) -->
                <div id="mfaSection" class="hidden">
                    <label for="mfaToken" class="block text-sm font-medium text-text-primary mb-2">
                        Multi-Factor Authentication Code
                        <span class="text-text-secondary text-xs">(Optional)</span>
                    </label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <img src="https://api.iconify.design/mdi:shield-lock-outline.svg?color=%236B7280" 
                                    alt="" 
                                    class="w-5 h-5"
                                    aria-hidden="true">
                        </div>
                        <input type="text" 
                                id="mfaToken" 
                                name="mfaToken" 
                                class="input pl-10" 
                                placeholder="Enter 6-digit code"
                                maxlength="6"
                                pattern="[0-9]{6}"
                                autocomplete="one-time-code"
                                aria-describedby="mfa-help">
                    </div>
                    <p id="mfa-help" class="mt-1 text-xs text-text-secondary">Enter the code from your authenticator app</p>
                </div>

                <!-- Remember Device & Forgot Password -->
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <input type="checkbox" 
                                id="rememberDevice" 
                                name="rememberDevice" 
                                class="w-4 h-4 text-primary border-border rounded focus:ring-2 focus:ring-primary-500 cursor-pointer">
                        <label for="rememberDevice" class="ml-2 text-sm text-text-secondary cursor-pointer">
                            Remember this device
                        </label>
                    </div>
                    <a href="javascript:void(0)" 
                        id="forgotPasswordLink"
                        class="text-sm text-primary hover:text-primary-700 focus-visible-ring rounded">
                        Forgot password?
                    </a>
                </div>

                <!-- Failed Attempt Warning -->
                <div id="failedAttemptWarning" class="hidden p-3 bg-warning-50 border border-warning-200 rounded-lg">
                    <div class="flex items-start gap-2">
                        <img src="https://api.iconify.design/mdi:alert-outline.svg?color=%23F59E0B" 
                                alt="" 
                                class="w-5 h-5 flex-shrink-0 mt-0.5"
                                aria-hidden="true">
                        <div class="flex-1">
                            <p class="text-sm font-medium text-warning-700">Security Notice</p>
                            <p class="text-xs text-warning-600 mt-1">
                                <span id="attemptCount">0</span> failed login attempts. Account will be locked after 5 attempts.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Session Timeout Warning -->
                <div id="sessionWarning" class="hidden p-3 bg-error-50 border border-error-200 rounded-lg">
                    <div class="flex items-start gap-2">
                        <img src="https://api.iconify.design/mdi:clock-alert-outline.svg?color=%23DC2626" 
                                alt="" 
                                class="w-5 h-5 flex-shrink-0 mt-0.5"
                                aria-hidden="true">
                        <div class="flex-1">
                            <p class="text-sm font-medium text-error-700">Session Timeout</p>
                            <p class="text-xs text-error-600 mt-1">Your previous session expired. Please log in again.</p>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" 
                        class="btn btn-primary w-full py-3 text-base font-medium shadow-md hover:shadow-lg"
                        id="loginButton">
                    <span id="buttonText">Sign In</span>
                    <img src="https://api.iconify.design/mdi:loading.svg?color=%23FFFFFF" 
                            alt="" 
                            class="w-5 h-5 ml-2 animate-spin hidden"
                            id="loadingSpinner"
                            aria-hidden="true">
                </button>

                <!-- Enable MFA Toggle -->
                <button type="button" 
                        id="enableMfaButton"
                        class="btn btn-outline w-full py-2.5 text-sm">
                    <img src="https://api.iconify.design/mdi:shield-check-outline.svg?color=%232563EB" 
                            alt="" 
                            class="w-5 h-5 mr-2"
                            aria-hidden="true">
                    Enable Multi-Factor Authentication
                </button>
            </form>

            <!-- Registration Link -->
            <div class="mt-6 pt-6 border-t border-border text-center">
                <p class="text-sm text-text-secondary">
                    New employee? 
                    <a href="javascript:void(0)" 
                        id="registerLink"
                        class="text-primary hover:text-primary-700 font-medium focus-visible-ring rounded">
                        Request Access
                    </a>
                </p>
                <p class="text-xs text-text-secondary mt-2">
                    Registration requires manager approval
                </p>
            </div>
        </article>

        <!-- Security Footer -->
        <footer class="mt-6 text-center">
            <div class="flex items-center justify-center gap-2 text-xs text-text-secondary mb-2">
                <img src="https://api.iconify.design/mdi:lock.svg?color=%236B7280" 
                        alt="" 
                        class="w-4 h-4"
                        aria-hidden="true">
                <span>All connections are encrypted and HIPAA compliant</span>
            </div>
            <p class="text-xs text-text-secondary">
                Â© 2025 PharmaCrew. All Rights Reserved. | 
                <a href="javascript:void(0)" class="hover:text-primary focus-visible-ring rounded">Privacy Policy</a> | 
                <a href="javascript:void(0)" class="hover:text-primary focus-visible-ring rounded">Terms of Service</a>
            </p>
        </footer>
    </main>

    <!-- Registration Modal -->
    <div id="registrationModal" class="fixed inset-0 bg-text-primary/50 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="card max-w-lg w-full p-6 animate-slide-up">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-semibold text-text-primary">Request Access</h2>
                <button type="button" 
                        id="closeModalButton"
                        class="text-text-secondary hover:text-text-primary focus-visible-ring rounded p-1"
                        aria-label="Close registration modal">
                    <img src="https://api.iconify.design/mdi:close.svg?color=%236B7280" 
                            alt="" 
                            class="w-6 h-6"
                            aria-hidden="true">
                </button>
            </div>
            <form id="registrationForm" class="space-y-4">
                <div>
                    <label for="regFullName" class="block text-sm font-medium text-text-primary mb-2">Full Name *</label>
                    <input type="text" 
                            id="regFullName" 
                            class="input" 
                            placeholder="Enter your full name"
                            required>
                </div>
                <div>
                    <label for="regEmail" class="block text-sm font-medium text-text-primary mb-2">Email Address *</label>
                    <input type="email" 
                            id="regEmail" 
                            class="input" 
                            placeholder="your.email@pharmacy.com"
                            required>
                </div>
                <div>
                    <label for="regRole" class="block text-sm font-medium text-text-primary mb-2">Requested Role *</label>
                    <select id="regRole" class="input" required>
                        <option value="">Select role</option>
                        <option value="pharmacist">Staff Pharmacist</option>
                        <option value="technician">Pharmacy Technician</option>
                    </select>
                </div>
                <div>
                    <label for="regPharmacy" class="block text-sm font-medium text-text-primary mb-2">Pharmacy Location *</label>
                    <input type="text" 
                            id="regPharmacy" 
                            class="input" 
                            placeholder="Enter pharmacy location"
                            required>
                </div>
                <div class="p-3 bg-primary-50 border border-primary-200 rounded-lg">
                    <p class="text-xs text-primary-700">
                        <img src="https://api.iconify.design/mdi:information-outline.svg?color=%232563EB" 
                                alt="" 
                                class="w-4 h-4 inline mr-1"
                                aria-hidden="true">
                        Your request will be sent to your pharmacy manager for approval. You'll receive an email once approved.
                    </p>
                </div>
                <button type="submit" class="btn btn-primary w-full">Submit Request</button>
            </form>
        </div>
    </div>
</body>
</html>